var t={},e={};function r(t){return"__proto__"!==t&&"constructor"!==t&&"prototype"!==t}var o={create:function(){t={},e={}},state:function(e){return e?t[e]:t},dispatch:function o(n,i,f,c,p){if(n&&"string"==typeof n){for(var l=n.split("->"),a=0;a<l.length;++a)if(!r(l[a]))return;if(!Object.prototype.hasOwnProperty.call(t,n)||t[n]!==i||f){if(t[n]=i,e[n])for(var s=0;s<e[n].length;++s)e[n][s](i);if("object"==typeof i&&null!==i&&!c)for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&o(n+"->"+u,i[u],f,!1,!0);if(!p&&l.length>1){var y=l[l.length-1],h=l.slice(0,-1).join("->");t[h]&&"object"==typeof t[h]||(t[h]={}),t[h][y]=i,o(h,t[h],!0,!0,!1)}}}},subscribe:function(r,o){if(r&&"string"==typeof r)return e[r]||(e[r]=[]),e[r].push(o),Object.prototype.hasOwnProperty.call(t,r)&&o(t[r]),function(){if(e[r]){var t=e[r].indexOf(o);-1!==t&&(e[r].splice(t,1),0===e[r].length&&delete e[r])}}}};exports.almy=o;