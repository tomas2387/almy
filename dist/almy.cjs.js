var t={},r={};function e(t){return"__proto__"!==t&&"constructor"!==t&&"prototype"!==t}var n={create:function(){t={},r={}},state:function(r){return r?t[r]:t},dispatch:function n(o,i,f,c,p){if(o&&"string"==typeof o){for(var l=o.split("->"),a=0;a<l.length;++a)if(!e(l[a]))return;if(!Object.prototype.hasOwnProperty.call(t,o)||t[o]!==i||f){if(t[o]=i,r[o])for(var s=0;s<r[o].length;++s)r[o][s](i);if("object"==typeof i&&null!==i&&!c)for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&n(o+"->"+u,i[u],f,!1,!0);if(!p&&l.length>1){var y=l[l.length-1],h=l.slice(0,-1).join("->");if(!e(h)||!e(y))return;t[h]&&"object"==typeof t[h]||(t[h]={}),t[h][y]=i,n(h,t[h],!0,!0,!1)}}}},subscribe:function(e,n){if(e&&"string"==typeof e)return r[e]||(r[e]=[]),r[e].push(n),Object.prototype.hasOwnProperty.call(t,e)&&n(t[e]),function(){if(r[e]){var t=r[e].indexOf(n);-1!==t&&(r[e].splice(t,1),0===r[e].length&&delete r[e])}}}};exports.almy=n;