!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).almy={})}(this,function(t){var e={},o={};function n(t){return"__proto__"!==t&&"constructor"!==t&&"prototype"!==t}var r={create:function(){e={},o={}},state:function(t){return t?e[t]:e},dispatch:function t(r,f,i,p,c){if(r&&"string"==typeof r){for(var l=r.split("->"),a=0;a<l.length;++a)if(!n(l[a]))return;if(!Object.prototype.hasOwnProperty.call(e,r)||e[r]!==f||i){if(e[r]=f,o[r])for(var s=0;s<o[r].length;++s)o[r][s](f);if("object"==typeof f&&null!==f&&!p)for(var u in f)Object.prototype.hasOwnProperty.call(f,u)&&t(r+"->"+u,f[u],i,!1,!0);if(!c&&l.length>1){var y=l[l.length-1],h=l.slice(0,-1).join("->");e[h]&&"object"==typeof e[h]||(e[h]={}),e[h][y]=f,t(h,e[h],!0,!0,!1)}}}},subscribe:function(t,n){if(t&&"string"==typeof t)return o[t]||(o[t]=[]),o[t].push(n),Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]),function(){if(o[t]){var e=o[t].indexOf(n);-1!==e&&(o[t].splice(e,1),0===o[t].length&&delete o[t])}}}};t.almy=r});