!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).almy={})}(this,function(t){var e={},n={},i={create:function(){e={},n={}},state:function(t){return t?e[t]:e},dispatch:function(t,i,o,f,s){if(t&&"string"==typeof t&&-1===t.indexOf("__proto__")&&(!Object.hasOwn(e,t)||e[t]!==i||o)){if(e[t]=i,n[t])for(var p=0;p<n[t].length;++p)n[t][p](i);if("object"==typeof i&&null!==i&&!f)for(var a in i)Object.hasOwn(i,a)&&this.dispatch(t+"->"+a,i[a],o,!1,!0);if(!s){var c=t.split("->");if(c.length>1){var r=c.pop(),d=c.join("->");e[d]&&"object"==typeof e[d]||(e[d]={}),e[d][r]=i,this.dispatch(d,e[d],!0,!0,!1)}}}},subscribe:function(t,i){t&&"string"==typeof t&&-1===t.indexOf("__proto__")&&(n[t]||(n[t]=[]),n[t].push(i),Object.hasOwn(e,t)&&i(e[t]))}};t.almy=i});