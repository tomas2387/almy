!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).almy=e()}(this,function(){var t={},e={};return{create:function(){t={},e={}},state:function(e){return e?t[e]:t},dispatch:function o(n,r,f,i,p){if(n&&"string"==typeof n){for(var l=n.split("->"),c=0;c<l.length;++c){var a=l[c];if("__proto__"===a||"constructor"===a||"prototype"===a)return}if(!Object.prototype.hasOwnProperty.call(t,n)||t[n]!==r||f){if(t[n]=r,e[n])for(var s=0;s<e[n].length;++s)e[n][s](r);if("object"==typeof r&&null!==r&&!i)for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&o(n+"->"+u,r[u],f,!1,!0);if(!p&&l.length>1){var y=l[l.length-1],d=l.slice(0,-1).join("->");t[d]&&"object"==typeof t[d]||(t[d]={}),t[d][y]=r,o(d,t[d],!0,!0,!1)}}}},subscribe:function(o,n){if(o&&"string"==typeof o)return e[o]||(e[o]=[]),e[o].push(n),Object.prototype.hasOwnProperty.call(t,o)&&n(t[o]),function(){if(e[o]){var t=e[o].indexOf(n);-1!==t&&(e[o].splice(t,1),0===e[o].length&&delete e[o])}}}}});